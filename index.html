<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Perinatal‑Substance‑Use Support Programmes in BC</title>

  <!-- Leaflet (no SRI so nothing gets blocked) -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <style>
    html, body { height:100%; margin:0; }
    #map       { height:100%; }
    .popup h3  { margin:0 0 .5rem; font-size:1.05rem; }
    .popup p   { margin:.25rem 0; }
    .popup small{ display:block; margin-top:.5rem; color:#555; }
  </style>
</head>
<body>
<div id="map"></div>

<script>
/* ---------- 1. Basemap ---------- */
const map = L.map('map', {scrollWheelZoom:true}).setView([53.5, -126.5], 5);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  maxZoom:19,
  attribution:'&copy; OpenStreetMap contributors'
}).addTo(map);

/* ---------- 2. Dataset: all 23 rows ---------- */
const programmes = {"type":"FeatureCollection","features":[
  {"type":"Feature","geometry":{"type":"Point","coordinates":[-119.493584522,49.884953705]},"properties":{"Label":"Tupa's Lodge","Type":"Bed-based recovery for moms/babies","Description":"Tupa's Lodge is an 8‑bed transitional housing programme for mothers who use substances and reside in BC’s Interior.","Organisation":"Ki‑Low‑Na Friendship Society","ServiceStream":"Indigenous approaches to care"}},
  {"type":"Feature","geometry":{"type":"Point","coordinates":[-123.01025425,49.269841953]},"properties":{"Label":"Burnaby Family Life","Type":"HCPP site","Description":"Perinatal outreach, parenting education and family support services.","Organisation":"","ServiceStream":""}},
  {"type":"Feature","geometry":{"type":"Point","coordinates":[-122.840679766,49.170584684]},"properties":{"Label":"Maxxine Wright PoP","Type":"Outreach program","Description":"Community‑based pregnancy outreach for women and gender‑diverse parents.","Organisation":"Maxxine Wright","ServiceStream":"Outpatient/community‑based care"}},
  {"type":"Feature","geometry":{"type":"Point","coordinates":[-123.046200502,49.237049284]},"properties":{"Label":"Together We Can – Northstar Programme","Type":"Bed-based recovery for moms/babies","Description":"Residential recovery for mothers and infants, providing wrap‑around supports.","Organisation":"Together We Can","ServiceStream":"Bed-based care"}},
  {"type":"Feature","geometry":{"type":"Point","coordinates":[-123.699231682,48.770148945]},"properties":{"Label":"Hiiye'yu Lelum Society – House of Honourable Men","Type":"Indigenous supportive housing","Description":"Supportive housing rooted in Coast Salish values, serving Island families.","Organisation":"Hiiye'yu Lelum Society","ServiceStream":"Indigenous approaches to care"}},
  {"type":"Feature","geometry":{"type":"Point","coordinates":[-123.35594616,48.44605078]},"properties":{"Label":"Sheway Victoria","Type":"Outreach program","Description":"Pregnancy outreach and family support for women who use substances.","Organisation":"Cool Aid Society","ServiceStream":"Outpatient/community‑based care"}},
  {"type":"Feature","geometry":{"type":"Point","coordinates":[-126.68477258,50.07013622]},"properties":{"Label":"Port Hardy Moms & Babies","Type":"Outreach program","Description":"Northern Vancouver Island outreach for perinatal families.","Organisation":"Island Health","ServiceStream":"Outpatient/community‑based care"}},
  {"type":"Feature","geometry":{"type":"Point","coordinates":[-124.98414035,49.68761573]},"properties":{"Label":"Tla'amin HCPP","Type":"HCPP site","Description":"Healthy Care for Pregnant Parents services for the Tla'amin Nation.","Organisation":"Tla'amin Nation","ServiceStream":"Indigenous approaches to care"}},
  {"type":"Feature","geometry":{"type":"Point","coordinates":[-123.0620668,49.24833673]},"properties":{"Label":"Fir Square Combined Unit","Type":"Hospital in‑patient unit","Description":"BC Women’s combined care unit for mothers and neonates exposed to substances.","Organisation":"BC Women’s Hospital","ServiceStream":"Bed-based care"}},
  {"type":"Feature","geometry":{"type":"Point","coordinates":[-123.14734378,49.18180008]},"properties":{"Label":"Families in Recovery (FIR)","Type":"Bed-based recovery for moms/babies","Description":"Residential withdrawal‑management and recovery (up to 12 weeks).","Organisation":"BC Women’s Hospital","ServiceStream":"Bed-based care"}},
  {"type":"Feature","geometry":{"type":"Point","coordinates":[-125.237099,50.029793]},"properties":{"Label":"Vancouver Island Moms & Babies Cottage","Type":"Bed-based recovery for moms/babies","Description":"Four‑bed cottage near Campbell River for recovery with infants.","Organisation":"Island Health","ServiceStream":"Bed-based care"}},
  {"type":"Feature","geometry":{"type":"Point","coordinates":[-122.8134111,53.913498]},"properties":{"Label":"Northern Health POP","Type":"Outreach program","Description":"Pregnancy outreach for women in Prince George and area.","Organisation":"Northern Health","ServiceStream":"Outpatient/community‑based care"}},
  {"type":"Feature","geometry":{"type":"Point","coordinates":[-118.188186,50.268884]},"properties":{"Label":"Nechako Valley Community Services","Type":"Outreach program","Description":"Perinatal substance‑use outreach in Vanderhoof area.","Organisation":"Nechako Valley Community Services","ServiceStream":"Outpatient/community‑based care"}},
  {"type":"Feature","geometry":{"type":"Point","coordinates":[-117.288157,50.997322]},"properties":{"Label":"Revelstoke POP","Type":"Outreach program","Description":"Pregnancy outreach for families in Revelstoke.","Organisation":"","ServiceStream":"Outpatient/community‑based care"}},
  {"type":"Feature","geometry":{"type":"Point","coordinates":[-121.325104,50.679541]},"properties":{"Label":"Lillooet POP","Type":"Outreach program","Description":"Pregnancy outreach for St’át’imc Territory.","Organisation":"","ServiceStream":"Outpatient/community‑based care"}},
  {"type":"Feature","geometry":{"type":"Point","coordinates":[-128.636974,54.314455]},"properties":{"Label":"Haida Gwaii POP","Type":"Outreach program","Description":"Pregnancy outreach on Haida Gwaii.","Organisation":"Haida Health Society","ServiceStream":"Outpatient/community‑based care"}},
  {"type":"Feature","geometry":{"type":"Point","coordinates":[-120.334685,56.236312]},"properties":{"Label":"Fort St John POP","Type":"Outreach program","Description":"Pregnancy outreach in Peace River region.","Organisation":"Northern Health","ServiceStream":"Outpatient/community‑based care"}},
  {"type":"Feature","geometry":{"type":"Point","coordinates":[-122.688658,49.108732]},"properties":{"Label":"Fraser Health FASU","Type":"Specialist team","Description":"Fraser Health Perinatal Substance Use Team (mobile).","Organisation":"Fraser Health","ServiceStream":"Specialist perinatal SU care"}},
  {"type":"Feature","geometry":{"type":"Point","coordinates":[-123.123952,49.284109]},"properties":{"Label":"Vancouver Coastal Health FASU","Type":"Specialist team","Description":"VCH Perinatal Substance Use Team (mobile).","Organisation":"VCH Public Health","ServiceStream":"Specialist perinatal SU care"}},
  {"type":"Feature","geometry":{"type":"Point","coordinates":[-124.496391,49.804949]},"properties":{"Label":"Island Health FASU","Type":"Specialist team","Description":"Island Health Perinatal Substance Use Team (mobile).","Organisation":"Island Health","ServiceStream":"Specialist perinatal SU care"}},
  {"type":"Feature","geometry":{"type":"Point","coordinates":[-118.198148,50.674522]},"properties":{"Label":"Interior Health FASU","Type":"Specialist team","Description":"Interior Health Perinatal Substance Use Team (mobile).","Organisation":"Interior Health","ServiceStream":"Specialist perinatal SU care"}},
  {"type":"Feature","geometry":{"type":"Point","coordinates":[-122.818834,53.939143]},"properties":{"Label":"Northern Health FASU","Type":"Specialist team","Description":"Northern Health Perinatal Substance Use Team (mobile).","Organisation":"Northern Health","ServiceStream":"Specialist perinatal SU care"}},
  {"type":"Feature","geometry":{"type":"Point","coordinates":[-123.970386,49.73378]},"properties":{"Label":"Vancouver Island Metis FASU","Type":"Specialist team","Description":"Métis Nation Island Health perinatal SU support.","Organisation":"Métis Nation BC","ServiceStream":"Specialist perinatal SU care"}}
]};

/* ---------- 3. Markers & pop‑ups ---------- */
function onEachFeature(feature, layer) {
  const p = feature.properties;
  const org = p.Organisation ? `<small>${p.Organisation}</small>` : '';
  layer.bindPopup(`
    <div class="popup">
      <h3>${p.Label}</h3>
      <p><strong>Type:</strong> ${p.Type || '—'}</p>
      <p>${p.Description || ''}</p>
      ${org}
    </div>
  `);
}

L.geoJSON(programmes, {
  onEachFeature,
  pointToLayer: (_, latlng) => L.circleMarker(latlng, {
    radius:6, weight:1, fillOpacity:0.8
  })
}).addTo(map);
</script>
</body>
</html>
